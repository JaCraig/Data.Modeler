<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Data.Modeler | Data.Modeler API Reference </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Data.Modeler | Data.Modeler API Reference ">
      
      
      <link rel="icon" href="favicon.ico">
      <link rel="stylesheet" href="public/docfx.min.css">
      <link rel="stylesheet" href="public/main.css">
      <meta name="docfx:navrel" content="toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="">
      
      
      <meta name="docfx:docurl" content="https://github.com/JaCraig/Data.Modeler/blob/master/docfx_project/index.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="index.html">
            <img id="logo" class="svg" src="images/icon.png" alt="Data.Modeler">
            Data.Modeler
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">

      <div class="content">
        <div class="actionbar">

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="datamodeler">Data.Modeler</h1>

<p><a href="https://ci.appveyor.com/project/JaCraig/data-modeler"><img src="https://ci.appveyor.com/api/projects/status/15bedpade50j03f2?svg=true" alt="Build status"></a></p>
<p>Data.Modeler is a library used to interact with model database schemas in C#. Works with .Net Core.</p>
<h2 id="basic-usage">Basic Usage</h2>
<p>In order to use Data.Modeler, you need to first wire up the system with your ServiceCollection. In order to do this, all you need to do is make one method call:</p>
<pre><code>serviceCollection.AddCanisterModules();
				
</code></pre>
<p>This line is required prior to using the DataModeler class for the first time. Once Canister is set up, you can call the DataModeler class provided:</p>
<pre><code>var SchemaProvider = DataModeler.GetSchemaGenerator(SqlClientFactory.Instance);
</code></pre>
<p>Note that the above gets the schema provider for SQL Server but for other databases you must provide the DbProviderFactory associated with it. You can also start creating a schema:</p>
<pre><code>var Source = DataModeler.CreateSource(&quot;MySource&quot;);
</code></pre>
<p>The &quot;MySource&quot; string is the database name that you wish to use.</p>
<h2 id="creating-a-schema">Creating a Schema</h2>
<p>Once you have your ISource object, you can start adding on to it:</p>
<pre><code>var Table = Source.AddTable(&quot;TableName&quot;, &quot;dbo&quot;);
var Column = Table.AddColumn&lt;int&gt;(&quot;ColumnName&quot;,DbType.Int32);
var CheckConstraint = Table.AddCheckConstraint(&quot;CheckConstraintName&quot;, &quot;Check Constraint Definition&quot;);
var View = Source.AddView(&quot;ViewName&quot;,&quot;View Creation Code&quot;, &quot;dbo&quot;);
var Function = Source.AddFunction(&quot;FunctionName&quot;,&quot;Function Creation Code&quot;, &quot;dbo&quot;);
var StoredProcedure = Source.AddStoredProcedure(&quot;StoredProcedureName&quot;,&quot;Stored Procedure Creation Code&quot;, &quot;dbo&quot;);
</code></pre>
<p>From there the schema provider can be used to either generate the commands needed to create the database or what commands are needed to alter an existing database to the desired schema:</p>
<pre><code>var MyCommands = SchemaProvider.GenerateSchema(DesiredSchema, SourceSchema);
</code></pre>
<p>If SourceSchema is null, then it will treat it as the database doesn't exist. If the SourceSchema is not null, it will act as though the database exists and the DesiredSchema is what you want the final schema to look like. Note that deleting columns, tables, etc. is not done by the system. It will, however, generate calls to drop functions, stored procedures, views, constraints, etc. if they need to be updated. Another thing you can do is have the system apply those changes for you:</p>
<pre><code>SchemaProvider.Setup(DesiredSchema,new Connection(Configuration, SqlClientFactory.Instance, &quot;Default&quot;));
</code></pre>
<p>The connection object must be fed a IConfiguration object, a DbProviderFactory for the database type you wish it to connect to, and either the name of your connection string in the configuration object or a connection string:</p>
<pre><code>SchemaProvider.Setup(DesiredSchema,new Connection(Configuration, SqlClientFactory.Instance, &quot;Data Source=localhost;Initial Catalog=ExampleDatabase;Integrated Security=SSPI;Pooling=false&quot;));
</code></pre>
<h2 id="adding-a-ischemagenerator">Adding a ISchemaGenerator</h2>
<p>The schema generator is what the system uses to generate the individual commands. Data.Modeler comes with one for SQL Server but in order to add your own you must create a class that inherits from ISchemaGenerator. From there the system will automatically pick up the schema generator and allow you to use it:</p>
<pre><code>var SchemaProvider = DataModeler.GetSchemaGenerator(MyDbFactoryProvider);
</code></pre>
<p>Note that you can also create one for SQL Server and the system will actually return the one that you create instead of the one built into the system.</p>
<h2 id="installation">Installation</h2>
<p>The library is available via Nuget with the package name &quot;Data.Modeler&quot;. To install it run the following command in the Package Manager Console:</p>
<p>Install-Package Data.Modeler</p>
<h2 id="build-process">Build Process</h2>
<p>In order to build the library you will require the following as a minimum:</p>
<ol>
<li>Visual Studio 2022</li>
</ol>
<p>Other than that, just clone the project and you should be able to load the solution and build without too much effort.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/JaCraig/Data.Modeler/blob/master/docfx_project/index.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <strong><a href='https://github.com/JaCraig/Data.Modeler'>Open in Github</a></strong>
        </div>
      </div>
    </footer>
  </body>
</html>
